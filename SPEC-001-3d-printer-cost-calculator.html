<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>SPEC-001: 3D Printer Cost Calculator</title>
<link rel="stylesheet" href="./asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>SPEC-001: 3D Printer Cost Calculator</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_background">1. Background</a></li>
<li><a href="#_requirements">2. Requirements</a>
<ul class="sectlevel2">
<li><a href="#_must_have">2.1. Must Have</a></li>
<li><a href="#_should_have">2.2. Should Have</a></li>
<li><a href="#_could_have">2.3. Could Have</a></li>
<li><a href="#_wont_have_initially">2.4. Won’t Have (initially)</a></li>
</ul>
</li>
<li><a href="#_method">3. Method</a>
<ul class="sectlevel2">
<li><a href="#_architecture_overview">3.1. Architecture Overview</a></li>
<li><a href="#_core_components">3.2. Core Components</a></li>
</ul>
</li>
<li><a href="#_implementation">4. Implementation</a>
<ul class="sectlevel2">
<li><a href="#_backend_asp_net_core">4.1. Backend (ASP.NET Core)</a></li>
<li><a href="#_frontend_angular">4.2. Frontend (Angular)</a></li>
</ul>
</li>
<li><a href="#_milestones">5. Milestones</a>
<ul class="sectlevel2">
<li><a href="#_milestone_1_core_parsing_cost_engine">5.1. Milestone 1: Core Parsing + Cost Engine</a></li>
<li><a href="#_milestone_2_project_folder_import">5.2. Milestone 2: Project Folder Import</a></li>
<li><a href="#_milestone_3_persistence_layer">5.3. Milestone 3: Persistence Layer</a></li>
<li><a href="#_milestone_4_advanced_tools">5.4. Milestone 4: Advanced Tools</a></li>
<li><a href="#_milestone_5_polish_and_release">5.5. Milestone 5: Polish and Release</a></li>
</ul>
</li>
<li><a href="#_gathering_results">6. Gathering Results</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_background">1. Background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the growing popularity of desktop and commercial 3D printing, there is an increasing need to accurately estimate the true cost of producing prints. Hobbyists, freelancers, and businesses often lack tools that provide transparent and customizable cost calculations. Current slicers offer some estimations, but they typically ignore factors like electricity, machine depreciation, labor, or failure risk.</p>
</div>
<div class="paragraph">
<p>This application aims to fill that gap by analyzing GCODE files generated by slicers and calculating comprehensive cost breakdowns. It will support granular configuration for materials, machines, and operations, enabling more informed pricing, quoting, and production planning.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements">2. Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_must_have">2.1. Must Have</h3>
<div class="ulist">
<ul>
<li>
<p>Parse GCODE files to extract:</p>
</li>
<li>
<p>Filament usage (length and weight)</p>
</li>
<li>
<p>Estimated print time</p>
</li>
<li>
<p>Layer count and height</p>
</li>
<li>
<p>Print settings (temperature, speed)</p>
</li>
<li>
<p>Cost calculation engine for:</p>
</li>
<li>
<p>Material cost (based on filament weight and price)</p>
</li>
<li>
<p>Electricity cost (based on printer power and time)</p>
</li>
<li>
<p>Machine depreciation cost</p>
</li>
<li>
<p>Simple UI to:</p>
</li>
<li>
<p>Upload/select GCODE file</p>
</li>
<li>
<p>Input material, electricity, and printer cost data</p>
</li>
<li>
<p>View cost breakdown</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_should_have">2.2. Should Have</h3>
<div class="ulist">
<ul>
<li>
<p>Failure rate adjustment for risk assessment</p>
</li>
<li>
<p>Save/load printer profiles with:</p>
</li>
<li>
<p>Power consumption</p>
</li>
<li>
<p>Purchase cost</p>
</li>
<li>
<p>Maintenance data</p>
</li>
<li>
<p>Save/load material profiles with:</p>
</li>
<li>
<p>Price per kg</p>
</li>
<li>
<p>Density and type</p>
</li>
<li>
<p>Project tracking and batch cost calculation</p>
</li>
<li>
<p>Folder-based GCODE import:</p>
</li>
<li>
<p>Recursively load project folders</p>
</li>
<li>
<p>Group cost reports based on folder hierarchy</p>
</li>
<li>
<p>Associate metadata (STL, 3MF, hyperlinks, timelapse) with prints</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_could_have">2.3. Could Have</h3>
<div class="ulist">
<ul>
<li>
<p>Visual analytics for:</p>
</li>
<li>
<p>Cost breakdowns</p>
</li>
<li>
<p>Historical cost tracking</p>
</li>
<li>
<p>Comparison of slicer settings</p>
</li>
<li>
<p>Client quote generation (PDF/CSV export)</p>
</li>
<li>
<p>Profit margin configuration</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_wont_have_initially">2.4. Won’t Have (initially)</h3>
<div class="ulist">
<ul>
<li>
<p>Real-time integration with slicers</p>
</li>
<li>
<p>Multi-material/multi-extruder support</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_method">3. Method</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_architecture_overview">3.1. Architecture Overview</h3>
<div class="paragraph">
<p>The application follows a modular client-server design:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Frontend (Angular)</strong>: UI for uploading GCODE files/folders, entering cost parameters, viewing cost breakdowns and print metadata.</p>
</li>
<li>
<p><strong>Backend (ASP.NET Core)</strong>: Handles GCODE parsing, cost calculation, profile management, and project/folder processing.</p>
</li>
<li>
<p><strong>Parsers</strong>: Individual services for handling GCODE from different slicers (Bambu, Orca, Creality).</p>
</li>
<li>
<p><strong>Cost Engine</strong>: Centralized component that calculates cost from parsed data.</p>
</li>
<li>
<p><strong>Project Processor</strong>: Recursively analyzes a folder of GCODE files, infers structure and metadata.</p>
</li>
<li>
<p><strong>Data Store</strong>: Stores printer profiles, materials, projects. Supports SQLite for local or PostgreSQL for hosted deployment.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_core_components">3.2. Core Components</h3>
<div class="sect3">
<h4 id="_parsedgcode_data_model">3.2.1. ParsedGcode Data Model</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class ParsedGcode
{
    public string SlicerName { get; set; }
    public string FileName { get; set; }
    public TimeSpan EstimatedPrintTime { get; set; }
    public float FilamentUsedGrams { get; set; }
    public float FilamentUsedMillimeters { get; set; }
    public float MaxZHeight { get; set; }
    public int LayerCount { get; set; }
    public float? NozzleTemperature { get; set; }
    public float? BedTemperature { get; set; }
    public float? AveragePrintSpeed { get; set; }
    public float ExtrusionVolume { get; set; }
    public Dictionary&lt;string, string&gt; ExtraMetadata { get; set; }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parser_interface">3.2.2. Parser Interface</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public interface IGcodeParser
{
    bool CanParse(string gcodeContent);
    ParsedGcode Parse(string gcodeContent);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_factory_pattern_for_parser_selection">3.2.3. Factory Pattern for Parser Selection</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class GcodeParserFactory
{
    private readonly IEnumerable&lt;IGcodeParser&gt; _parsers;

    public GcodeParserFactory(IEnumerable&lt;IGcodeParser&gt; parsers)
    {
        _parsers = parsers;
    }

    public IGcodeParser GetParser(string content)
    {
        return _parsers.FirstOrDefault(p =&gt; p.CanParse(content))
            ?? throw new InvalidOperationException("No suitable parser found.");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_centralized_parsing_utilities">3.2.4. Centralized Parsing Utilities</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public static class GcodeParserUtils
{
    public static float? ExtractSingleFloat(string content, string marker) { ... }
    public static TimeSpan? ExtractEstimatedTime(string content) { ... }
    public static int CountLayers(string content) { ... }
    public static float? ExtractMaxZ(string content) { ... }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_costcalculationengine">3.2.5. CostCalculationEngine</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-math" data-lang="math">TotalCost = MaterialCost + ElectricityCost + DepreciationCost + LaborCost + Profit</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class CostCalculationInput
{
    public ParsedGcode Gcode { get; set; }
    public float FilamentPricePerKg { get; set; }
    public float ElectricityPricePerKWh { get; set; }
    public float PrinterPowerWatts { get; set; }
    public float PrinterCost { get; set; }
    public float PrinterLifetimeHours { get; set; }
    public float SetupTimeHours { get; set; }
    public float LaborRatePerHour { get; set; }
    public float ProfitMarginPercent { get; set; }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_projectfolderprocessor">3.2.6. ProjectFolderProcessor</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class PrintProject
{
    public string GroupName { get; set; }
    public string ProjectName { get; set; }
    public ParsedGcode GcodeData { get; set; }
    public List&lt;string&gt; STLFiles { get; set; }
    public List&lt;string&gt; MP4Timelapses { get; set; }
    public string SourceUrl { get; set; }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_component_diagram">3.2.7. Component Diagram</h4>
<div class="listingblock">
<div class="content">
<pre>@startuml
package "Backend (.NET Core)" {
  [GcodeParserFactory] --&gt; [BambuGcodeParser]
  [GcodeParserFactory] --&gt; [OrcaGcodeParser]
  [GcodeParserFactory] --&gt; [CrealityGcodeParser]

  [ProjectFolderProcessor] --&gt; [GcodeParserFactory]
  [GcodeParserFactory] --&gt; [ParsedGcode]
  [ParsedGcode] --&gt; [CostCalculationEngine]
}

package "Frontend (Angular)" {
  [Gcode Upload UI] --&gt; [API Controller]
  [API Controller] --&gt; [ProjectFolderProcessor]
  [API Controller] --&gt; [CostCalculationEngine]
}
@enduml</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation">4. Implementation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_backend_asp_net_core">4.1. Backend (ASP.NET Core)</h3>
<div class="ulist">
<ul>
<li>
<p>Implement models: <code>ParsedGcode</code>, <code>PrintProject</code>, <code>CostCalculationInput</code></p>
</li>
<li>
<p>Implement <code>IGcodeParser</code> for each slicer</p>
</li>
<li>
<p>Register parsers and factory via DI</p>
</li>
<li>
<p>Implement <code>CostCalculationEngine</code> and <code>ProjectFolderProcessor</code></p>
</li>
<li>
<p>Create REST API endpoints for file parsing, folder processing, and cost calculation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_frontend_angular">4.2. Frontend (Angular)</h3>
<div class="ulist">
<ul>
<li>
<p>Upload UI for GCODE file/folder ZIP</p>
</li>
<li>
<p>Cost input UI with optional profile prefill</p>
</li>
<li>
<p>Display cost breakdowns for single and batch prints</p>
</li>
<li>
<p>Add project browser grouped by folders</p>
</li>
<li>
<p>Show STL/MP4/URL metadata where available</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_milestones">5. Milestones</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_milestone_1_core_parsing_cost_engine">5.1. Milestone 1: Core Parsing + Cost Engine</h3>
<div class="ulist">
<ul>
<li>
<p>Complete core parsers (Bambu, Orca, Creality)</p>
</li>
<li>
<p>File upload UI and manual cost calculator</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_milestone_2_project_folder_import">5.2. Milestone 2: Project Folder Import</h3>
<div class="ulist">
<ul>
<li>
<p>Recursive ZIP parsing and project grouping</p>
</li>
<li>
<p>Display multiple cost breakdowns</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_milestone_3_persistence_layer">5.3. Milestone 3: Persistence Layer</h3>
<div class="ulist">
<ul>
<li>
<p>Store/load profiles and projects via EF Core</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_milestone_4_advanced_tools">5.4. Milestone 4: Advanced Tools</h3>
<div class="ulist">
<ul>
<li>
<p>Quote exports, analytics, labor/profit inputs</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_milestone_5_polish_and_release">5.5. Milestone 5: Polish and Release</h3>
<div class="ulist">
<ul>
<li>
<p>Full testing, styling, deployment prep</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gathering_results">6. Gathering Results</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Validate parser correctness with real GCODEs</p>
</li>
<li>
<p>Cross-check cost breakdowns against manual calculations</p>
</li>
<li>
<p>Collect usability feedback from testers</p>
</li>
<li>
<p>Confirm performance and parsing under batch load</p>
</li>
<li>
<p>Evaluate success by user adoption and quoting use cases</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-05-13 09:05:13 UTC
</div>
</div>
</body>
</html>